<?xml version="1.0" encoding="UTF-8"?>  <!-- xml 문서입니다 하는 내용 -->

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.shop.dao.TestOneDao">
	<select id="listDao" resultType="com.shop.dto.TestOneDto">
		select k.*, a.al_opic, a.al_name, a.al_abv, a.al_price, a.al_stock, f.*
		from al_kinds k join alcohols a on k.ki_num=a.ki_num
		                join flavors f on a.al_num=f.al_num
		order by a.al_num desc
	</select>
	
	<select id="viewDao" resultType="com.shop.dto.TestOneDto">
		select t.*, a.al_name, a.al_price, a.al_stock, a.al_opic, a.al_abv, a.al_volume, a.al_jaeryo, f.*
		from test_board t join alcohols a on  t.al_num=a.al_num
		    join al_kinds k on a.ki_num=k.ki_num
		    join flavors f on a.al_num=f.al_num
		where t.board_num=#{0}
	</select>
	

	<insert id="writeDao" parameterType="java.util.HashMap">
		insert into test_board (boardNum, alName, itemDetail, itemStatus, alPrice, alStock, itemDate, auth, authdanmat, authssunmat, authsinmat, authbody, authtansan, abv )
		values (test_board_seq.nextval, #{alName}, #{itemDetail}, #{itemStatus}, #{alPrice}, #{alStock}, #{itemDate}, #{auth}, #{authdanmat}, #{authssunmat}, #{authsinmat}, #{authbody}, #{authtansan}, #{abv} )
	</insert>
	
	
	<delete id="deleteDao">
		delete from test_board where board_num = #{_boardNum}
	</delete>	
	
	<select id="postCount" resultType="_int">
		select count(*) from test_board 
	</select>
	
	
	<update id="updateDao" parameterType="java.util.HashMap">
		update test_board
		set alName=#{alName}, itemDetail=#{itemDetail}, itemStatus=#{itemStatus}, alPrice=#{alPrice}, alStock=#{alStock}, auth=#{auth}, authdanmat=#{authdanmat}, authssunmat=#{authssunmat}, authsinmat=#{authsinmat}, authbody=#{authbody}, authtansan=#{authtansan}, abv=#{abv}
		where boardNum=#{boardNum}
	</update>
	
	
	<select id="getAuthItemList" resultType="com.shop.dto.TestOneDto">
		SELECT k.*, a.al_opic, a.al_name, a.al_abv, a.al_price, a.al_stock, f.*
		FROM al_kinds k join alcohols a on k.ki_num=a.ki_num
                join flavors f on a.al_num=f.al_num
		<where>
			<if test="chkArray != null">
				a.ki_num IN
				<foreach collection="chkArray" item="item" open="(" close=")" separator=",">
					 #{item}
				</foreach>
			</if>
			<if test="chkDanmat != null">
				AND f.fl_danmat IN
					<foreach collection="chkDanmat" item="item" open="(" close=")" separator=",">
						 #{item}
					</foreach>
			</if>
			<if test="chkFlSinmat != null">
				AND f.fl_sinmat IN
					<foreach collection="chkFlSinmat" item="item" open="(" close=")" separator=",">
						 #{item}
					</foreach>
			</if>
			<if test="chkFlSsunmat != null">
				AND f.fl_ssunmat IN
					<foreach collection="chkFlSsunmat" item="item" open="(" close=")" separator=",">
						 #{item}
					</foreach>
			</if>
			<if test="chkFlBody != null">
				AND f.fl_body IN
					<foreach collection="chkFlBody" item="item" open="(" close=")" separator=",">
						 #{item}
					</foreach>
			</if>
			<if test="chkFlTansan != null">
				AND f.fl_tansan IN
					<foreach collection="chkFlTansan" item="item" open="(" close=")" separator=",">
						 #{item}
					</foreach>
			</if>
			
		</where>
					
						
		ORDER BY a.al_num desc
	</select>
	

	
	
	
</mapper>

